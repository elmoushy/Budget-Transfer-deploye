import{d as he,a as Ye,r as l,u as ge,y as Y,w as ae,e as c,F as be,h as D,G as d,f as e,t as o,b as F,H as Qe,m as V,Q as Ge,n as p,p as se,s as v,_ as _e,o as ce,D as _,v as Ke,I as ve,C as We,J as Ze,i as ee,K as pe,g as te,T as et,L as tt}from"./index-BgPRSccL.js";import{a as at}from"./apiService-BW7cI8eQ.js";import{F as ye}from"./FuturisticPopup-BJDE4UtG.js";import{E as st}from"./EditTransferModal-B19JqMCO.js";import{T as ot,S as lt,P as nt,_ as it,A as rt,R as me,O as ut}from"./shared-page-styles-DCre9rgq.js";import{t as fe}from"./TransferService-DZQaS7Nc.js";import{S as dt}from"./search-BaSehBhs.js";import"./check-DwKFmcGe.js";const ct={class:"modal-header"},vt={class:"modal-body"},pt={class:"form-group"},mt={for:"timePeriod",class:"required"},ft={class:"select-wrapper"},ht={value:"",disabled:""},gt={value:"Jan"},bt={value:"Feb"},_t={value:"Mar"},yt={value:"Apr"},kt={value:"May"},Ct={value:"Jun"},wt={value:"Jul"},Mt={value:"Aug"},xt={value:"Sep"},$t={value:"Oct"},Tt={value:"Nov"},Dt={value:"Dec"},Pt={class:"form-group"},St={for:"transferReason",class:"required"},Lt={key:0,class:"error-message"},qt={class:"modal-footer"},Rt=he({__name:"NewRequestModal",props:{modelValue:{type:Boolean,default:!1}},emits:["update:modelValue","submit"],setup(Q,{emit:P}){const E=Q,S=P;Ye();const m=l("<p>Enter your reason here...</p>"),h=l(!1),L=l({timePeriod:"",transferReason:""}),X=[["bold","italic","underline","strike"],[{list:"ordered"},{list:"bullet"}],[{align:[]}],["clean"]],U={placeholder:"Enter your reason here...",modules:{toolbar:X}},A=ge(),i=Y(()=>A.language==="ar"),I=Y(()=>A.darkMode),y=l(!1),f=l("info"),q=l(""),R=l("");function M(){B(),S("update:modelValue",!1)}function B(){L.value={timePeriod:"",transferReason:""},m.value="<p>Enter your reason here...</p>",h.value=!1}async function j(){const x=m.value==="<p>Enter your reason here...</p>"||m.value==="<p><br></p>"||m.value==="";if(!L.value.timePeriod||x){x&&(h.value=!0),f.value="warning",q.value=i.value?"تنبيه!":"Warning!",R.value=i.value?"يرجى ملء جميع الحقول المطلوبة":"Please fill all required fields",y.value=!0;return}h.value=!1;try{const r={transaction_date:L.value.timePeriod,notes:m.value,type:"FAR"},g=await at.transfers.createTransfer(r);S("submit",g.data),M()}catch(r){console.error("Error creating transfer request:",r),f.value="error",q.value=i.value?"خطأ!":"Error!",R.value=i.value?"حدث خطأ أثناء إنشاء الطلب":"Error creating request",y.value=!0}}return ae(()=>E.modelValue,x=>{x&&B()}),(x,r)=>(v(),c(be,null,[Q.modelValue?(v(),c("div",{key:0,class:"modal-overlay",onClick:M},[e("div",{class:p(["modal-container",{"dark-mode":I.value}]),onClick:r[2]||(r[2]=se(()=>{},["stop"]))},[e("div",ct,[e("h2",null,o(i.value?"طلب مناقلة جديد":"New Transfer Request"),1),e("button",{class:"close-modal",onClick:M},"×")]),e("div",vt,[e("div",pt,[e("label",mt,o(i.value?"الفترة الزمنية":"Time Period"),1),e("div",ft,[F(e("select",{id:"timePeriod","onUpdate:modelValue":r[0]||(r[0]=g=>L.value.timePeriod=g),required:""},[e("option",ht,o(i.value?"اختر فترة":"Select period"),1),e("option",gt,o(i.value?"يناير":"January"),1),e("option",bt,o(i.value?"فبراير":"February"),1),e("option",_t,o(i.value?"مارس":"March"),1),e("option",yt,o(i.value?"أبريل":"April"),1),e("option",kt,o(i.value?"مايو":"May"),1),e("option",Ct,o(i.value?"يونيو":"June"),1),e("option",wt,o(i.value?"يوليو":"July"),1),e("option",Mt,o(i.value?"أغسطس":"August"),1),e("option",xt,o(i.value?"سبتمبر":"September"),1),e("option",$t,o(i.value?"أكتوبر":"October"),1),e("option",Tt,o(i.value?"نوفمبر":"November"),1),e("option",Dt,o(i.value?"ديسمبر":"December"),1)],512),[[Qe,L.value.timePeriod]]),r[4]||(r[4]=e("div",{class:"select-arrow"},"▼",-1))])]),e("div",Pt,[e("label",St,o(i.value?"سبب المناقلة":"Reason for Transfer"),1),d(V(Ge),{content:m.value,"onUpdate:content":r[1]||(r[1]=g=>m.value=g),toolbar:X,contentType:"html",theme:"snow",options:U,class:p(["transfer-editor",{"editor-error":h.value}])},null,8,["content","class"]),h.value?(v(),c("div",Lt,o(i.value?"هذا الحقل مطلوب":"This field is required"),1)):D("",!0)])]),e("div",qt,[e("button",{class:"btn-secondary",onClick:M},o(i.value?"إلغاء":"Cancel"),1),e("button",{class:"btn-primary submit-btn",onClick:j},o(i.value?"إنشاء":"Create"),1)])],2)])):D("",!0),d(ye,{show:y.value,"onUpdate:show":r[3]||(r[3]=g=>y.value=g),type:f.value,title:q.value,message:R.value,timer:3e3},null,8,["show","type","title","message"])],64))}}),Vt=_e(Rt,[["__scopeId","data-v-aedace27"]]),Et={class:"page-toolbar toolbar glass-panel"},Xt={class:"btn-text"},At={class:"toolbar-right"},Nt={class:"search-container"},Ft=["placeholder"],Ut={class:"page-table-container table-container glass-panel",delay:200},Bt={key:"head"},jt={key:"body"},Ht=["delay"],Ot={class:"action-buttons"},It=["onClick","disabled","title"],zt=["onClick","disabled","title"],Jt={class:"code-cell"},Yt={class:"description-cell"},Qt=["onClick"],Gt=["onClick"],Kt=["onClick"],Wt={class:"attachment-cell"},Zt=["onClick","title"],ea={key:0,class:"attachment-badge"},ta=["title","onClick"],aa={key:"loading"},sa={colspan:"9",class:"loading-row"},oa={key:"no-results"},la={colspan:"9",class:"no-results"},na={class:"pagination"},ia=["disabled"],ra={class:"page-info"},ua=["disabled"],da={class:"modal-header"},ca={class:"modal-body desc-modal-body"},va=["innerHTML"],pa={key:1,class:"no-desc"},ma={class:"modal-header futuristic-header"},fa={class:"modal-body futuristic-body"},ha={class:"delete-message futuristic-message"},ga={key:0,class:"delete-info"},ba={class:"info-item"},_a={class:"info-label"},ya={class:"info-value"},ka={class:"info-item"},Ca={class:"info-label"},wa={class:"info-value"},Ma={class:"modal-footer futuristic-footer"},xa=he({name:"HomePage",__name:"Home",setup(Q){const P=l(!1),E=l(null),S=l([]),m=l(0),h=l(!1),L=l(!1),X=l(!1),U=l(!1),A=l(""),i=l(!1),I=l(null),y=l(!1),f=l(null),q=l(!1),R=l(0),M=l(!1),B=l(null),j=l(!1),x=l(0),r=l(!1),g=l("info"),oe=l(""),le=l("pending"),G=l(!1),K=l(!1);function ne(s){return s?new Date(s).toLocaleDateString():""}function ke(s){return s||""}function Ce(s){A.value=s.notes||"",U.value=!0}function ie(){U.value=!1}function we(s){I.value=s,i.value=!0}function Me(s){s.status.toLowerCase()==="pending"&&(f.value=s,y.value=!0)}function W(){y.value=!1,f.value=null}function xe(){f.value&&(P.value=!0,y.value=!1,fe.deleteTransfer(f.value.transaction_id).then(()=>{C(),re("success",n.value?"تم حذف الطلب بنجاح":"Request deleted successfully")}).catch(s=>{console.error("Error deleting request:",s),re("error",n.value?"حدث خطأ أثناء حذف الطلب":"Error deleting the request")}).finally(()=>{P.value=!1,f.value=null}))}function $e(s){const t=s.toLowerCase();return t==="approved"?"row-approved":t==="pending"?"row-pending":t==="rejected"?"row-rejected":"row-none"}function Te(s){R.value=s.transaction_id,le.value=s.status.toLowerCase(),q.value=!0}function De(s){s.status.toLowerCase()==="rejected"&&(x.value=s.transaction_id,j.value=!0)}function Pe(s){K.value=!0}function Se(){C()}function Le(s){const t=s.attachment_count?n.value?`${s.attachment_count} مرفقات - انقر للعرض`:`${s.attachment_count} attachments - Click to view`:n.value?"لا توجد مرفقات":"No attachments";if(s.status.toLowerCase()!=="pending"){const u=n.value?" (وضع القراءة فقط)":" (read-only mode)";return t+u}return t}function qe(s){B.value=s,M.value=!0}function Re(s){const u=s.target.closest(".search-container");u&&u.classList.add("focused")}function Ve(s){const t=s.target,u=t.closest(".search-container");u&&(u.classList.remove("focused"),t.value?u.classList.add("has-value"):u.classList.remove("has-value"))}function Ee(){document.querySelectorAll(".page-table-row").forEach(t=>{t.addEventListener("mousemove",u=>{const $=u,T=t.getBoundingClientRect(),N=$.clientX-T.left,a=$.clientY-T.top,J=T.width/2,w=T.height/2,de=.5,ze=(N-J)/J*de,Je=(a-w)/w*de;t.style.transform=`translate(${ze}px, ${Je}px)`}),t.addEventListener("mouseleave",()=>{t.style.transform="translate(0, 0)",t.style.transition="transform 0.5s cubic-bezier(0.16, 1, 0.3, 1)",setTimeout(()=>{t.style.transition=""},500)})})}ce(()=>{setTimeout(()=>{Ee()},1e3),Xe()});function Xe(){const s=(u,$)=>Math.floor(Math.random()*($-u+1)+u);document.querySelectorAll(".gradient-orb").forEach(u=>{const $=u;setInterval(()=>{const T=s(-30,30),N=s(-30,30);$.style.transform=`translate(${T}px, ${N}px)`},8e3)})}function re(s,t){g.value=s,oe.value=t,r.value=!0}const z=ge(),n=l(!1),H=l(!1);ce(()=>{n.value=z.language==="ar",H.value=z.darkMode,C()}),ae(()=>z.language,s=>n.value=s==="ar"),ae(()=>z.darkMode,s=>H.value=s);const Ae={attachment:"Attachment",statusLevel:"Status Level",giPostingStatus:"posting Status - oracle System",transferPeriod:"Transfer Period",requestDate:"Request Date",transferDescription:"Transfer Description",requestedBy:"Requested By",code:"Code",action:"Action"},Ne={attachment:"مرفقات",statusLevel:"مستوى حالة الطلب",giPostingStatus:"حالة المعاملة في نظام الأوراكل",transferPeriod:"شهر المعاملة",requestDate:"تاريخ الطلب",transferDescription:"وصف المعاملة",requestedBy:"طلب من",code:"الرمز",action:"الإجراء"},k=Y(()=>n.value?Ne:Ae),O=l(""),b=l(1),Z=l(null);async function C(){P.value=!0;try{const s=await fe.fetchTransfers(O.value,b.value);E.value=s,S.value=s.results||[],m.value=s.count||0,h.value=!!s.next,L.value=!!s.previous}catch(s){console.error("Error in component while fetching data:",s),S.value=[]}finally{P.value=!1}}function Fe(){Z.value&&clearTimeout(Z.value),Z.value=setTimeout(()=>{b.value=1,C()},300)}function Ue(){O.value="",b.value=1,C()}function Be(){h.value&&(b.value++,C())}function je(){b.value>1&&(b.value--,C())}const ue=Y(()=>{if(m.value===0)return 1;if(E.value&&E.value.next){const t=new URL(E.value.next).searchParams.get("page_size");if(t)return Math.ceil(m.value/parseInt(t))}return Math.ceil(m.value/6)});function He(){X.value=!0}function Oe(s){console.log("New request submitted:",s),C()}function Ie(s){console.log("Transfer updated:",s),C()}return(s,t)=>{const u=Ze("router-link"),$=te("motion-slide-top"),T=te("motion-slide-right"),N=te("motion-slide-bottom");return v(),c("div",{class:p(["page-container home-page",{"dark-mode":H.value}])},[t[28]||(t[28]=e("div",{class:"page-background"},[e("div",{class:"gradient-orb orb-1"}),e("div",{class:"gradient-orb orb-2"}),e("div",{class:"gradient-orb orb-3"})],-1)),F((v(),c("div",Et,[e("button",{class:"btn-primary glass-btn",onClick:He},[t[12]||(t[12]=e("span",{class:"btn-icon"},"+",-1)),e("span",Xt,o(n.value?"طلب ملاحظة جديدة":"New Request"),1),t[13]||(t[13]=e("div",{class:"btn-glint"},null,-1))]),e("div",At,[e("div",Nt,[d(V(dt),{class:"search-icon",style:_({transform:n.value?"translateX(-200px)":"translateX(200px)"})},null,8,["style"]),F(e("input",{"onUpdate:modelValue":t[0]||(t[0]=a=>O.value=a),type:"search",placeholder:n.value?"بحث...":"Search...",class:"input-search",onInput:Fe,onFocus:Re,onBlur:Ve},null,40,Ft),[[Ke,O.value]]),O.value?(v(),c("button",{key:0,onClick:Ue,class:"clear-search glass-btn-icon"},t[14]||(t[14]=[e("span",null,"×",-1)]))):D("",!0),t[15]||(t[15]=e("div",{class:"search-focus-indicator"},null,-1))])])])),[[$]]),F((v(),c("div",Ut,[d(et,{name:"table-fade",tag:"table",class:"page-table main-table"},{default:ve(()=>[e("thead",Bt,[e("tr",null,[e("th",null,[e("p",{style:_({transform:n.value?"translateX(70px)":"translateX(30px)"})},o(k.value.action),5)]),e("th",null,[e("p",{style:_({transform:n.value?"translateX(75px)":"translateX(40px)"})},o(k.value.code),5)]),e("th",null,[e("p",{style:_({transform:n.value?"translateX(35px)":"translateX(30px)"})},o(k.value.requestedBy),5)]),e("th",null,[e("p",{style:_({transform:n.value?"translateX(40px)":"translateX(30px)"})},o(k.value.transferDescription),5)]),e("th",null,[e("p",{style:_({transform:n.value?"translateX(50px)":"translateX(30px)"})},o(k.value.requestDate),5)]),e("th",null,[e("p",{style:_({transform:n.value?"translateX(45px)":"translateX(30px)"})},o(k.value.transferPeriod),5)]),e("th",null,[e("p",{style:_({transform:n.value?"translateX(56px)":"translateX(30px)"})},o(k.value.giPostingStatus),5)]),e("th",null,[e("p",{style:_({transform:n.value?"translateX(69px)":"translateX(30px)"})},o(k.value.statusLevel),5)]),e("th",null,[e("p",{style:_({transform:n.value?"translateX(95px)!important":"translateX(30px)"})},o(k.value.attachment),5)])])]),e("tbody",jt,[(v(!0),c(be,null,We(S.value,(a,J)=>F((v(),c("tr",{key:a.transaction_id,class:p([$e(a.status),"page-table-row table-row"]),delay:300+J*50},[e("td",null,[e("div",Ot,[e("button",{class:p(["icon-btn delete-btn",{"disabled-btn":a.status.toLowerCase()!=="pending"}]),onClick:w=>a.status.toLowerCase()==="pending"?Me(a):null,disabled:a.status.toLowerCase()!=="pending",title:a.status.toLowerCase()==="pending"?n.value?"حذف":"Delete":n.value?"لا يمكن حذف العناصر غير المعلقة":"Cannot delete non-pending items"},[d(V(ot))],10,It),e("button",{class:p(["icon-btn",{"disabled-btn":a.status.toLowerCase()!=="pending"}]),onClick:w=>a.status.toLowerCase()==="pending"?we(a):null,disabled:a.status.toLowerCase()!=="pending",title:a.status.toLowerCase()==="pending"?"Edit":"Cannot edit non-pending items"},[d(V(lt))],10,zt)])]),e("td",Jt,[d(u,{to:`/cost-center-transfer/${a.transaction_id}`,class:"code-link"},{default:ve(()=>[ee(o(a.code),1)]),_:2},1032,["to"])]),e("td",null,o(a.requested_by),1),e("td",null,[e("div",Yt,[e("button",{class:"icon-btn view-desc-btn",onClick:w=>Ce(a),title:"View full description"},[d(V(pe))],8,Qt)])]),e("td",null,o(ne(a.request_date)),1),e("td",null,o(a.transaction_date),1),e("td",null,[e("span",{class:"track-link",onClick:w=>Pe(a)},"Track",8,Gt)]),e("td",null,[e("span",{class:p(["status-badge","status-"+a.status.toLowerCase()]),onClick:w=>qe(a),role:"button"},o(a.status),11,Kt)]),e("td",null,[e("div",Wt,[e("span",{class:p(["attachment-text",{"with-attachments":a.attachment_count&&a.attachment_count>0}])},o(a.attachment_count&&a.attachment_count>0?`${a.attachment_count} attachments`:"No attachments"),3),e("div",{class:p(["attachment-indicator",{"has-attachments":a.attachment_count&&a.attachment_count>0,"no-attachments":!a.attachment_count}]),onClick:w=>Te(a),title:Le(a)},[d(V(nt),{size:18}),a.attachment_count&&a.attachment_count>0?(v(),c("span",ea,o(a.attachment_count),1)):D("",!0)],10,Zt),e("div",{class:p(["rejection-indicator",{disabled:a.status.toLowerCase()!=="rejected"}]),title:n.value?"تقارير الرفض":"Rejection reports",onClick:w=>a.status.toLowerCase()==="rejected"&&De(a)},[d(V(pe),{size:18})],10,ta)])])],10,Ht)),[[T]])),128)),P.value?(v(),c("tr",aa,[e("td",sa,o(n.value?"جاري التحميل...":"Loading..."),1)])):S.value.length===0?(v(),c("tr",oa,[e("td",la,o(n.value?"لا توجد نتائج":"No results found"),1)])):D("",!0)])]),_:1})])),[[N]]),e("div",na,[e("button",{onClick:je,class:p(["page-btn",{disabled:b.value===1}]),disabled:b.value===1},o(n.value?"السابق":"Previous"),11,ia),e("span",ra,o(n.value?`صفحة ${b.value} من ${ue.value}`:`Page ${b.value} of ${ue.value}`),1),e("button",{onClick:Be,class:p(["page-btn",{disabled:!h.value}]),disabled:!h.value},o(n.value?"التالي":"Next"),11,ua)]),d(Vt,{modelValue:X.value,"onUpdate:modelValue":t[1]||(t[1]=a=>X.value=a),onSubmit:Oe},null,8,["modelValue"]),d(st,{modelValue:i.value,"onUpdate:modelValue":t[2]||(t[2]=a=>i.value=a),transferData:I.value||{},onSubmit:Ie},null,8,["modelValue","transferData"]),U.value?(v(),c("div",{key:0,class:"modal-overlay",onClick:ie},[e("div",{class:p(["desc-modal-container",{"dark-mode":H.value}]),onClick:t[3]||(t[3]=se(()=>{},["stop"]))},[e("div",da,[e("h2",null,o(n.value?"وصف المعاملة":"Transfer Description"),1),e("button",{class:"close-modal",onClick:ie},"×")]),e("div",ca,[A.value?(v(),c("div",{key:0,class:"desc-content",innerHTML:ke(A.value)},null,8,va)):(v(),c("div",pa,o(n.value?"لا يوجد وصف":"No description available"),1))])],2)])):D("",!0),y.value?(v(),c("div",{key:1,class:"modal-overlay futuristic-overlay",onClick:W},[F((v(),c("div",{class:p(["delete-modal-container futuristic-modal",{"dark-mode":H.value}]),onClick:t[4]||(t[4]=se(()=>{},["stop"]))},[t[23]||(t[23]=e("div",{class:"modal-glow-effect"},null,-1)),e("div",ma,[t[17]||(t[17]=e("div",{class:"modal-decorator left"},null,-1)),e("h2",null,o(n.value?"تأكيد الحذف":"Confirm Deletion"),1),t[18]||(t[18]=e("div",{class:"modal-decorator right"},null,-1)),e("button",{class:"close-modal futuristic-close",onClick:W},t[16]||(t[16]=[e("span",{class:"close-icon"},"×",-1),e("span",{class:"close-pulse"},null,-1)]))]),e("div",fa,[t[19]||(t[19]=e("div",{class:"warning-icon-container"},[e("div",{class:"warning-icon"},[e("div",{class:"warning-circle"}),e("span",null,"!")]),e("div",{class:"warning-pulse"})],-1)),e("p",ha,o(n.value?"هل أنت متأكد من رغبتك في حذف هذا الطلب؟":"Are you sure you want to delete this request?"),1),f.value?(v(),c("div",ga,[e("div",ba,[e("span",_a,o(n.value?"الرمز:":"Code:"),1),e("span",ya,o(f.value.code),1)]),e("div",ka,[e("span",Ca,o(n.value?"التاريخ:":"Date:"),1),e("span",wa,o(ne(f.value.request_date)),1)])])):D("",!0)]),e("div",Ma,[e("button",{class:"btn-secondary futuristic-btn-secondary",onClick:W},[ee(o(n.value?"إلغاء":"Cancel")+" ",1),t[20]||(t[20]=e("span",{class:"btn-glow"},null,-1))]),e("button",{class:"btn-primary delete-confirm-btn futuristic-btn-delete",onClick:xe},[t[21]||(t[21]=tt('<span class="btn-icon" data-v-553e9a68><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-553e9a68><polyline points="3 6 5 6 21 6" data-v-553e9a68></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2" data-v-553e9a68></path><line x1="10" y1="11" x2="10" y2="17" data-v-553e9a68></line><line x1="14" y1="11" x2="14" y2="17" data-v-553e9a68></line></svg></span>',1)),ee(" "+o(n.value?"نعم، حذف":"Yes, Delete")+" ",1),t[22]||(t[22]=e("span",{class:"btn-glow delete-glow"},null,-1))])]),t[24]||(t[24]=e("div",{class:"modal-corner top-left"},null,-1)),t[25]||(t[25]=e("div",{class:"modal-corner top-right"},null,-1)),t[26]||(t[26]=e("div",{class:"modal-corner bottom-left"},null,-1)),t[27]||(t[27]=e("div",{class:"modal-corner bottom-right"},null,-1))],2)),[[N]])])):D("",!0),d(it,{show:q.value,"onUpdate:show":t[5]||(t[5]=a=>q.value=a),"transaction-id":R.value,status:le.value,onFilesUpdated:Se},null,8,["show","transaction-id","status"]),d(rt,{modelValue:M.value,"onUpdate:modelValue":t[6]||(t[6]=a=>M.value=a),"approval-data":B.value||{}},null,8,["modelValue","approval-data"]),d(me,{show:j.value,"onUpdate:show":t[7]||(t[7]=a=>j.value=a),"transaction-id":x.value},null,8,["show","transaction-id"]),d(ye,{show:r.value,"onUpdate:show":t[8]||(t[8]=a=>r.value=a),type:g.value,message:oe.value,duration:3e3},null,8,["show","type","message"]),d(me,{modelValue:G.value,"onUpdate:modelValue":t[9]||(t[9]=a=>G.value=a),"transaction-id":R.value,onClose:t[10]||(t[10]=a=>G.value=!1)},null,8,["modelValue","transaction-id"]),d(ut,{modelValue:K.value,"onUpdate:modelValue":t[11]||(t[11]=a=>K.value=a)},null,8,["modelValue"])],2)}}}),Va=_e(xa,[["__scopeId","data-v-553e9a68"]]);export{Va as default};
